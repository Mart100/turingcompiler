6 0 0 0 0 0 0 0 0 6 !5 2 0 1 0 1 1 0 0 1 3 0 0 0 0 0 0 0 0 4

START 5 5 L TO_S1_END

# To end of S1
TO_S1_END 6 6 L SET_TO_7

# Set all the values to 7 untill the start of S1
SET_TO_7 0 7 L SET_TO_7
SET_TO_7 1 7 L SET_TO_7
SET_TO_7 6 9 R TO_MIDDLE_R

# Find the middle
TO_MIDDLE_R 7 7 R TO_MIDDLE_R
TO_MIDDLE_R 1 1 R TO_MIDDLE_R
TO_MIDDLE_R 0 0 R TO_MIDDLE_R
TO_MIDDLE_R 2 2 R TO_MIDDLE_R
TO_MIDDLE_R 6 6 R TO_MIDDLE_R
TO_MIDDLE_R 5 5 R COPY_VALUE

# Move Left until start of A
# Copy the first non-7/8 value
COPY_VALUE 0 7 L MOVE_ZERO
COPY_VALUE 1 8 L MOVE_ONE
COPY_VALUE 2 2 R COPY_VALUE
COPY_VALUE 7 7 R COPY_VALUE
COPY_VALUE 8 8 R COPY_VALUE
COPY_VALUE 3 3 L RESTORE_VALUE

## MOVE IF VALUE IS 0

# Move a 0 to the end of number A
MOVE_ZERO 0 0 L MOVE_ZERO
MOVE_ZERO 1 1 L MOVE_ZERO
MOVE_ZERO 2 2 L MOVE_ZERO
MOVE_ZERO 3 3 L MOVE_ZERO
MOVE_ZERO 5 5 L MOVE_ZERO
MOVE_ZERO 6 6 L MOVE_ZERO
MOVE_ZERO 7 7 L MOVE_ZERO
MOVE_ZERO 8 8 L MOVE_ZERO
MOVE_ZERO 9 9 R MOVE_ZERO_2

# Move a 0 to the left until the first 7, and replace it
MOVE_ZERO_2 0 0 R MOVE_ZERO_2
MOVE_ZERO_2 1 1 R MOVE_ZERO_2
MOVE_ZERO_2 7 0 S TO_MIDDLE_R

## MOVE IF VALUE IS 1
# Move a 1 to the start of the first number
MOVE_ONE 0 0 L MOVE_ONE
MOVE_ONE 1 1 L MOVE_ONE
MOVE_ONE 2 2 L MOVE_ONE
MOVE_ONE 3 3 L MOVE_ONE
MOVE_ONE 5 5 L MOVE_ONE
MOVE_ONE 6 6 L MOVE_ONE
MOVE_ONE 7 7 L MOVE_ONE
MOVE_ONE 8 8 L MOVE_ONE
MOVE_ONE 9 9 R MOVE_ONE_2

# Move a 1 to the left until the first 7, and replace it
MOVE_ONE_2 0 0 R MOVE_ONE_2
MOVE_ONE_2 1 1 R MOVE_ONE_2
MOVE_ONE_2 7 1 S TO_MIDDLE_R

# Restore number A, translate 7 to 0 and 8 to 1
RESTORE_VALUE 7 0 L RESTORE_VALUE
RESTORE_VALUE 8 1 L RESTORE_VALUE
RESTORE_VALUE 2 2 L RESET_STORAGE_MARKER

# Reset 9 to 6
RESET_STORAGE_MARKER 5 5 L RESET_STORAGE_MARKER
RESET_STORAGE_MARKER 0 0 L RESET_STORAGE_MARKER
RESET_STORAGE_MARKER 1 1 L RESET_STORAGE_MARKER
RESET_STORAGE_MARKER 6 6 L RESET_STORAGE_MARKER
RESET_STORAGE_MARKER 9 6 R RETURN_TO_MIDDLE

# Return to middle
RETURN_TO_MIDDLE 0 0 R RETURN_TO_MIDDLE
RETURN_TO_MIDDLE 1 1 R RETURN_TO_MIDDLE
RETURN_TO_MIDDLE 6 6 R RETURN_TO_MIDDLE
RETURN_TO_MIDDLE 5 5 S END
